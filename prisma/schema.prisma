// prisma/schema.prisma
generator client {
  provider = "prisma-client-js"
  output   = "../lib/generated/prisma"
}

datasource db {
  provider = "postgresql"
}

enum Status {
  NEW
  VALIDATED
  CURRENT
}

model Stage {
  id             String            @id @default(uuid())
  langue         Langue
  title          String
  statusStage    Status            @default(NEW)
  niveau         String
  valide         Boolean           @default(false)
  image          String
  numOrder       Int
  createdAt      DateTime          @default(now())
  updatedAt      DateTime          @updatedAt
  descriptions   Paragraphe[]
  jeux           Jeu[]
}

model Paragraphe {
  id      String  @id @default(uuid())
  texte   String
  stageId String?
  stage   Stage?  @relation(fields: [stageId], references: [id])
}

model Section {
  id             String            @id @default(uuid())
  title          String
  langue         Langue
  statusSection  Status            @default(NEW)
  image          String
  niveau         String
  valide         Boolean           @default(false)
  numOrder       Int
  createdAt      DateTime          @default(now())
  updatedAt      DateTime          @updatedAt
  jeux           Jeu[]
 
}

model Jeu {
  id        String  @id @default(uuid())
  langue    Langue
  image     String?
  niveau    String
  statusJeu Status  @default(NEW)
  numOrder  Int
  valide    Boolean @default(false)
  stageId   String
  stage     Stage?  @relation(fields: [stageId], references: [id])

  sectionId String?
  section   Section? @relation(fields: [sectionId], references: [id])

  questions Question[]
}

model Question {
  id       String    @id @default(uuid())
  langue   Langue
  intitule String
  orderNum Int
  status   Status    @default(NEW)
  valide   Boolean   @default(false)
  reponses Reponse[]

  jeuId String?
  jeu   Jeu?    @relation(fields: [jeuId], references: [id])
}

model Reponse {
  id        String  @id @default(uuid())
  intitule  String
  langue    Langue
  isCorrect Boolean
  questionId String?
  question   Question? @relation(fields: [questionId], references: [id])
}

model User {
  id             String            @id @default(uuid())
  clerkId        String            @unique
  email          String            @unique
  langue         String?           @default("FR")
  firstName      String
  lastName       String
  country        String?
  phone          String?
  createdAt      DateTime          @default(now())
  updatedAt      DateTime          @updatedAt
  role           UserRole          @default(JOUEUR)
  palmares       Palmares[]


}


enum UserRole {
  ADMIN
  JOUEUR
  MANAGER
}


model Palmares {
  id String @id @default(uuid())
  userId String?
  user   User?   @relation(fields: [userId], references: [id])
  compteurJeu Int @default(1)
  stageLength Int @default(1)
  score            Int?
  jeuNiveauValide String?
  jeuValide        Boolean @default(false)
  createdAt        DateTime          @default(now())
}


enum Langue {
  FR
  EN
  ES
  PT
  DE
}
