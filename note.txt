

ngrok http --url=robin-prime-goose.ngrok-free.app 3000 //DO NOT USE IT

1. Run 'prisma dev 'to start a local Prisma Postgres server.
2. Define models in the "schema.prisma" file.
3. Run "prisma migrate dev" to migrate your local Prisma Postgres database. 


consider this 
=========================================================
npm i prisma
npx prisma init
npx prisma dev
=>schematfile
||| npx prisma migrate dev
|||| npx prisma generate
|||| npx prisma db push
npm i @prisma/client
npm i --save-dev prisma@latest                       │
npm i @prisma/client@latest 

npx prisma db push --force-reset 

===========================================================

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
  output   = "../lib/generated/prisma"
}

model Stage {
    id String @id @default(uuid())
    title String 
    niveau String
    image String
    numOrder Int 
    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt
    sections Section[]
}

model Section {
  id String @id @default(uuid())
  title String
  image String
  niveau String
  numOrder Int
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  stageId String?
  stockage Stage? @relation(fields: [stageId], references: [id])
  jeux Jeu[]
}

model Jeu {
  id String @id @default(uuid())
  title String
  image String?
  niveau String
  numOrder Int
  sectionId String?
  jeuValide Boolean @default(false)
  section Section? @relation(fields: [sectionId], references: [id])
  questions Question[]
  palmares Palmares[] // opposite relation field for Palmares.jeu
}

model Question {
  id String @id @default(uuid())
  intitule String
  image String?
  orderNum Int
  reponses Reponse[]
  jeuId String?
  jeu Jeu? @relation(fields: [jeuId], references: [id])

}

model Reponse {
  id String @id @default(uuid())
  intitule String
  isCorrect Boolean
  questionId String?
  question Question? @relation(fields: [questionId], references: [id])
}

model User {
  id            String     @id @default(uuid())
  clerkId       String     @unique
  email         String     @unique
  langue        String
  firstName     String?
  lastName      String?
  country       String?
  phone         String?
  name          String?
  createdAt     DateTime   @default(now())
  updatedAt     DateTime   @updatedAt
  role          UserRole   @default(JOUEUR)
  dernierNiveau String?
  palmares      Palmares[]
}

enum UserRole {
  ADMIN
  JOUEUR
  MANAGER
}

model Palmares {
  id String @id @default(uuid())
  userId String?
  user User? @relation(fields: [userId], references: [id])
  jeuId String?
  jeu Jeu? @relation(fields: [jeuId], references: [id])
  score Int
  isFinished Boolean
  createdAt DateTime @default(now())
}

=========================================

import { PrismaClient } from "@prisma/client";

const globalForPrisma = globalThis as unknown as { prisma: PrismaClient | undefined}

export const prisma = globalForPrisma.prisma ?? new PrismaClient();

if (process.env.NODE_ENV !== "production") {
    globalForPrisma.prisma = prisma;
}

================================================

DATABASE_URL="postgresql://neondb_owner:npg_k6SVbfia0rGP@ep-spring-block-a8ody3fm-pooler.eastus2.azure.neon.tech/neondb?sslmode=require&channel_binding=require"
# uncomment next line if you use Prisma <5.10
DATABASE_URL_UNPOOLED="postgresql://neondb_owner:npg_k6SVbfia0rGP@ep-spring-block-a8ody3fm.eastus2.azure.neon.tech/neondb?sslmode=require&channel_binding=require"
#CLERK
NEXT_PUBLIC_CLERK_PUBLISHABLE_KEY=pk_test_bmF0aXZlLWdlY2tvLTUuY2xlcmsuYWNjb3VudHMuZGV2JA
CLERK_SECRET_KEY=sk_test_cdMpTf47zOxr63fiD1k1KutSe4AZJgv96xiBHT5zNc

SIGNING_SECRET=whsec_Xh842mnHMiB7OUXdgDdBnYuAj2EP4isz





============================================================New good================
                                                                                                                                                                                                                                                                                                                                                                                                ============================GO OO OD Joueur LATEST +++++++++++++++++++++++++++++++++++++++++++++++++++
the the page joueur.tsx at line 50, when we click the button "Commencer à jouer", 
we want to check if current user has a palmares ? 
if no,  create a palmares for the current user with 
palmares.user===current user,
palmares.compteurJeu,
palmares.stageLength,
palmares.score===0,
palmares.jeuNiveauValide,
palmares.jeuValide,

then redirect to page /fr/joueur/emboard.tsx

if yes, redirect toto page /fr/joueur/emboard.tsx


+++++++++++++++++++++++++++++nEXT page EMBOARD GOOD ++++++++++++++++++++++++++>>>>
in this page /fr/joueur/emboard.tsx select all stage, section, jeu and  palmares related to this current user from prisma data base.

select stage where stage.numOrder===palmares.compteurJeu and display selected stage.title, stage.image and  stage.descriptions by mapping throught the stage.descriptions and place a button "Commençons" in the bottom.

when we click the button "Commençons" in the bottom it redirects to page /fr/joueur/emboad/jeuSection.tsx


=====================================JeuSection GOOOOOD+++++++++++++++++++++++++++++++++++++++

in the page /fr/joueur/emboard/jeuSection.tsx, 
select section where section.numOrder===palmares.compteurSection and 
select jeu where jeu.numOrder===palmares.compteurJeu and get all question and response related to the selected jeu FROM PRISMA DATA BASE
then display in the left the selected section section.image and the rigth display question one afte another with it related response until the end of question related this selected response. 



++++++++++++++++++++++++VICTORIEUX++++++++++++++++++++++++++++++++++++++++++
in case of victory, we update the current palmares with 
create a palmares for the current user with 
palmares.user===current user,
palmares.compteurJeu,
palmares.stageLength,
palmares.score===score,
palmares.jeuNiveauValide===stage.niveau section.niveau,
palmares.jeuValide===true,

then check if palmares.stageLength is inferior or equal to stage length ?

if yes, create new palmares 

new palmares.user===current user,
new palmares.compteurJeu===previous palmares.compteurJeu+1,
new palmares.stageLength===previous palmares.stageLength+1,
new palmares.score===0,
new palmares.jeuNiveauValide,
new palmares.jeuValide,

then redirect to page /fr/joueur/emboard.tsx

if palmares.stageLength is superior to stage length then 
create new palmares 

new palmares.user===current user,
new palmares.compteurJeu===previous palmares.compteurJeu+1,
new palmares.stageLength===1,
new palmares.score===0,
new palmares.jeuNiveauValide,
new palmares.jeuValide,

then redirect to page /fr/joueur/transitStage.tsx

==========================transitStage++++++++++++++++++
in this page /fr/joueur/transitStage.tsx select all stage, section, jeu and  palmares related to this current user from prisma data base.

select stage where stage.numOrder===palmares.compteurJeu and display selected stage.title, stage.image and  stage.descriptions by mapping throught the stage.descriptions and place a button "Commençons" in the bottom.

when we click the button "Commençons" in the bottom it redirects to page /fr/joueur/emboad/jeuSection.tsx

